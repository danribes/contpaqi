# T011.4 Add 500ms Delay Between Operations - Implementation Log

## Overview
Added mandatory delay between SDK operations as required by ContPAQi SDK.

## Files Modified
- `windows-bridge/src/ContpaqiBridge/Services/JobQueueService.cs`

## Implementation Details

### Why Delay is Required
ContPAQi SDK has limitations:
1. Single-threaded access only
2. Database connections need time to settle
3. File locks need time to release
4. COM object cleanup requires time

### Implementation
```csharp
private async Task ProcessJobWithRetryAsync(InvoiceJob job, CancellationToken stoppingToken)
{
    while (job.RetryCount <= MaxRetries)
    {
        try
        {
            await ProcessJobAsync(job);

            job.Status = JobStatus.Completed;
            job.CompletedAt = DateTime.UtcNow;

            // SDK requires delay between operations
            await Task.Delay(500, stoppingToken);
            return;
        }
        catch (Exception ex)
        {
            // Retry logic...
        }
    }
}
```

### Delay Configuration
```csharp
// Could be made configurable
private const int OperationDelayMs = 500;

// Usage
await Task.Delay(OperationDelayMs, stoppingToken);
```

### Impact on Throughput
| Delay (ms) | Max Jobs/sec | Notes |
|------------|--------------|-------|
| 0 | N/A | Unstable |
| 250 | 4 | May have issues |
| 500 | 2 | Recommended |
| 1000 | 1 | Very safe |

## Notes
- Delay is per job, not per SDK call
- Delay respects cancellation token
- 500ms is conservative but safe
