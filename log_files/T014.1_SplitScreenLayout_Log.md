# T014.1 Split-Screen Layout - Implementation Log

## Subtask Information
- **Task**: 14 - Human-in-the-Loop UI
- **Subtask**: 14.1 - Create split-screen layout (PDF + form)
- **Date**: 2025-12-08
- **Status**: Complete

## Implementation Details

### Overview
This subtask implements a resizable split-screen layout for the invoice verification interface, allowing users to view the PDF document side-by-side with the extracted invoice data form.

### Files Created/Modified

#### 1. `desktop-app/src/components/SplitScreenLayout.tsx` (Created)
New component file providing the split-screen layout with the following features:

**Exported Components:**
- `SplitScreenLayout`: Main container with resizable panels
- `PanelHeader`: Header with title and collapse/expand buttons
- `ResizeDivider`: Draggable divider between panels
- `ModeToggle`: Toggle buttons for layout modes
- `PDFPanelPlaceholder`: Placeholder for PDF viewer (for 14.2)
- `FormPanelPlaceholder`: Placeholder for invoice form (for 14.3)

**Exported Types:**
```typescript
type LayoutMode = 'split' | 'pdf-only' | 'form-only';
type PanelPosition = 'left' | 'right';
type Breakpoint = 'mobile' | 'tablet' | 'desktop';
```

**Helper Functions:**
- `getBreakpoint(width)`: Determine responsive breakpoint
- `getDefaultMode(breakpoint)`: Get default mode for breakpoint
- `isResizableAtBreakpoint(breakpoint)`: Check if resize is enabled
- `constrainWidth(width, min, max)`: Clamp width to bounds
- `isPanelVisible(panel, mode)`: Check panel visibility
- `getNextMode(mode, direction)`: Cycle through modes

#### 2. `desktop-app/src/App.tsx` (Modified)
Integrated split-screen layout:
- Added `AppView` type ('upload' | 'verification')
- Added `currentView` and `layoutMode` state
- Added verification view with split-screen layout
- Added navigation between upload and verification views
- Added demo button to test verification view

#### 3. `desktop-app/tests/split-screen-layout.test.ts` (Created)
35 tests covering:
- Layout mode logic
- Width constraints
- Resize calculations
- Panel visibility
- Responsive behavior
- Divider state
- Mode toggle
- Panel headers
- Default configuration

### Key Features

#### Resizable Split Panels
```typescript
<SplitScreenLayout
  leftPanel={<PDFPanelPlaceholder />}
  rightPanel={<FormPanelPlaceholder />}
  initialLeftWidth={50}
  minLeftWidth={25}
  maxLeftWidth={75}
  resizable={true}
  mode={layoutMode}
  onModeChange={setLayoutMode}
/>
```

#### Layout Modes
| Mode | Description |
|------|-------------|
| `split` | Both panels visible, resizable divider |
| `pdf-only` | Only PDF panel, form hidden |
| `form-only` | Only form panel, PDF hidden |

#### Responsive Behavior
| Breakpoint | Width | Default Mode | Resizable |
|------------|-------|--------------|-----------|
| mobile | <640px | pdf-only | No |
| tablet | 640-1023px | split | Yes |
| desktop | >=1024px | split | Yes |

#### Drag Resize
- Draggable divider with visual feedback
- Mouse events for drag start/move/end
- Width constrained to min/max bounds
- Smooth transitions

### Technical Decisions

1. **Controlled & Uncontrolled Mode**: Component supports both controlled (via props) and uncontrolled (internal state) mode management
2. **Responsive Design**: Auto-switches to appropriate mode on breakpoint changes
3. **Accessibility**: Includes visual feedback for hover/drag states
4. **Placeholder Components**: Ready for PDF viewer and form integration in subsequent subtasks

### Integration Points
- App.tsx: Uses SplitScreenLayout for verification view
- StatusIndicator: Shows status in verification header
- Future: PDFPanelPlaceholder → react-pdf viewer (14.2)
- Future: FormPanelPlaceholder → InvoiceForm (14.3)

## API

### SplitScreenLayoutProps
```typescript
interface SplitScreenLayoutProps {
  leftPanel: ReactNode;
  rightPanel: ReactNode;
  initialLeftWidth?: number; // default: 50
  minLeftWidth?: number;     // default: 25
  maxLeftWidth?: number;     // default: 75
  resizable?: boolean;       // default: true
  mode?: LayoutMode;
  onModeChange?: (mode: LayoutMode) => void;
  onResize?: (leftWidth: number) => void;
  leftTitle?: string;        // default: "PDF Document"
  rightTitle?: string;       // default: "Invoice Data"
  className?: string;
}
```

## Dependencies
- React (useState, useRef, useCallback, useEffect)
- Tailwind CSS for styling

## User Experience Flow
1. User uploads PDF from upload view
2. App switches to verification view
3. Split-screen shows PDF on left, form on right
4. User can resize panels by dragging divider
5. User can toggle to PDF-only or form-only mode
6. Back button returns to upload view
