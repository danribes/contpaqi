# T010.3 Add COM Reference to MGW_SDK.dll - Implementation Log

## Overview
Prepared COM interop structure for MGW_SDK.dll. Since we're developing on Linux, created P/Invoke declarations as placeholders.

## Files Created
- `windows-bridge/src/ContpaqiBridge/Sdk/SdkInterop.cs`

## Implementation Details

### P/Invoke Declarations
```csharp
private const string SDK_DLL = "MGW_SDK.dll";

[DllImport(SDK_DLL, CallingConvention = CallingConvention.Cdecl)]
private static extern int MGW_InicializaSDK(
    [MarshalAs(UnmanagedType.LPStr)] string dataPath);

[DllImport(SDK_DLL, CallingConvention = CallingConvention.Cdecl)]
private static extern void MGW_TerminaSDK();

[DllImport(SDK_DLL, CallingConvention = CallingConvention.Cdecl)]
private static extern int MGW_CreaPoliza(
    int tipo, int diario,
    [MarshalAs(UnmanagedType.LPStr)] string fecha,
    [MarshalAs(UnmanagedType.LPStr)] string concepto);
```

### Marshaling Strategy
| C# Type | Native Type | Marshaling |
|---------|-------------|------------|
| string | char* | LPStr (ANSI) |
| int | int | Direct |
| bool | int | Implicit (0/1) |

### Why P/Invoke Instead of COM Reference
- COM references require Windows and registered type libraries
- P/Invoke works cross-platform for structure definition
- Actual calls will only work on Windows with SDK installed

## Notes
- CallingConvention.Cdecl matches ContPAQi SDK
- ANSI strings (LPStr) for legacy compatibility
- Error codes returned as integers
