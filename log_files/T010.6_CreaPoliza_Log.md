# T010.6 Map fCreaPoliza Function - Implementation Log

## Overview
Mapped the poliza (journal entry) creation function for inserting accounting records.

## Files Modified
- `windows-bridge/src/ContpaqiBridge/Sdk/SdkInterop.cs`
- `windows-bridge/src/ContpaqiBridge/Sdk/ISdkInterop.cs`

## Implementation Details

### PolizaData Structure
```csharp
public class PolizaData
{
    public int Tipo { get; set; }        // 1=Ingreso, 2=Egreso, 3=Diario
    public DateTime Fecha { get; set; }
    public string Concepto { get; set; } = string.Empty;
    public int Diario { get; set; }      // Journal number
}
```

### Real Implementation
```csharp
public SdkResult<int> CreaPoliza(PolizaData poliza)
{
    if (!_initialized)
    {
        return new SdkResult<int>
        {
            Success = false,
            ErrorCode = -2,
            ErrorMessage = "SDK not initialized"
        };
    }

    try
    {
        var fechaStr = poliza.Fecha.ToString("yyyyMMdd");
        var polizaId = MGW_CreaPoliza(
            poliza.Tipo,
            poliza.Diario,
            fechaStr,
            poliza.Concepto
        );

        if (polizaId > 0)
        {
            return new SdkResult<int> { Success = true, Value = polizaId };
        }
        else
        {
            return new SdkResult<int>
            {
                Success = false,
                ErrorCode = polizaId,
                ErrorMessage = $"Failed to create poliza: {polizaId}"
            };
        }
    }
    catch (Exception ex)
    {
        return new SdkResult<int>
        {
            Success = false,
            ErrorCode = -1,
            ErrorMessage = ex.Message
        };
    }
}
```

### Poliza Types
| Tipo | Description |
|------|-------------|
| 1 | Ingreso (Income) |
| 2 | Egreso (Expense) |
| 3 | Diario (Journal) |

## Notes
- Returns positive poliza ID on success
- Returns negative error code on failure
- Date format must be YYYYMMDD
