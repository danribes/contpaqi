# T018.3 - English Language File Guide

## Overview

This guide covers the creation of a comprehensive English language file for the ContPAQi AI Bridge desktop application using i18next, a popular internationalization framework for JavaScript/TypeScript applications.

---

## i18next Translation File Structure

### JSON Format

i18next uses JSON files for translations. Each language has its own file:

```
src/i18n/locales/
├── en.json    # English translations
└── es.json    # Spanish translations
```

### Hierarchical Keys

Translations are organized hierarchically for maintainability:

```json
{
  "section": {
    "subsection": {
      "key": "Translation value"
    }
  }
}
```

Access with dot notation: `t('section.subsection.key')`

---

## Translation File Organization

### Recommended Sections

| Section | Purpose | Example Keys |
|---------|---------|--------------|
| `app` | Application metadata | name, tagline, version |
| `status` | Status messages | ready, error, loading |
| `actions` | Button labels | submit, cancel, save |
| `settings` | Settings UI | language, theme |
| `invoice` | Invoice form | form fields, messages |
| `validation` | Validation errors | required, invalid format |
| `errors` | Error messages | network, timeout |
| `navigation` | Menu items | home, settings |
| `common` | Shared strings | yes, no, ok |

### Example Structure

```json
{
  "app": {
    "name": "ContPAQi AI Bridge",
    "tagline": "Intelligent Invoice Processing"
  },
  "actions": {
    "submit": "Submit",
    "cancel": "Cancel",
    "save": "Save"
  },
  "invoice": {
    "form": {
      "title": "Invoice Details",
      "rfcEmisor": "RFC Emisor"
    },
    "messages": {
      "submitSuccess": "Invoice submitted successfully"
    }
  }
}
```

---

## Interpolation

### Dynamic Values

Use `{{variable}}` syntax for dynamic content:

```json
{
  "greeting": "Hello, {{name}}!",
  "itemCount": "{{count}} items selected",
  "dateRange": "From {{start}} to {{end}}"
}
```

### Usage in React

```tsx
const { t } = useTranslation();

// Simple interpolation
t('greeting', { name: 'John' });
// Output: "Hello, John!"

// Multiple variables
t('dateRange', { start: '2024-01-01', end: '2024-12-31' });
// Output: "From 2024-01-01 to 2024-12-31"
```

---

## Best Practices

### 1. Consistent Naming

```json
// Good: camelCase, descriptive
{
  "submitButton": "Submit",
  "cancelButton": "Cancel",
  "errorNetwork": "Network error"
}

// Avoid: inconsistent, abbreviated
{
  "submit_btn": "Submit",
  "Cancel": "Cancel",
  "err_net": "Network error"
}
```

### 2. Context-Specific Translations

```json
// Good: Different contexts have different translations
{
  "invoice": {
    "submit": "Submit Invoice"
  },
  "form": {
    "submit": "Submit Form"
  }
}
```

### 3. Placeholders for Form Fields

```json
{
  "form": {
    "email": "Email Address"
  },
  "placeholders": {
    "email": "Enter your email address"
  }
}
```

### 4. User-Friendly Error Messages

```json
// Good: Actionable message
{
  "errors": {
    "network": "Network error. Please check your connection."
  }
}

// Avoid: Technical jargon
{
  "errors": {
    "network": "ERR_NETWORK_TIMEOUT"
  }
}
```

### 5. Accessibility Strings

```json
{
  "accessibility": {
    "skipToContent": "Skip to content",
    "loading": "Loading, please wait",
    "required": "Required field"
  }
}
```

---

## Using Translations in React

### Basic Usage

```tsx
import { useTranslation } from 'react-i18next';

function MyComponent() {
  const { t } = useTranslation();

  return (
    <div>
      <h1>{t('app.name')}</h1>
      <p>{t('app.tagline')}</p>
    </div>
  );
}
```

### With Interpolation

```tsx
function ItemCounter({ count }) {
  const { t } = useTranslation();

  return (
    <span>{t('common.selected', { count })}</span>
  );
}
// Output: "5 selected"
```

### Form Labels and Placeholders

```tsx
function InvoiceForm() {
  const { t } = useTranslation();

  return (
    <form>
      <label>{t('invoice.form.rfcEmisor')}</label>
      <input
        placeholder={t('invoice.placeholders.rfcEmisor')}
      />
    </form>
  );
}
```

### Conditional Messages

```tsx
function StatusMessage({ status }) {
  const { t } = useTranslation();

  // Access dynamic key
  const message = t(`status.${status}`);

  return <span>{message}</span>;
}
```

---

## Pluralization

### i18next Plural Format

```json
{
  "item": "{{count}} item",
  "item_plural": "{{count}} items",
  "item_zero": "No items"
}
```

### Usage

```tsx
t('item', { count: 0 });  // "No items"
t('item', { count: 1 });  // "1 item"
t('item', { count: 5 });  // "5 items"
```

---

## Testing Translation Files

### Key Existence Tests

```typescript
test.each(requiredKeys)('has "%s" key', (key) => {
  expect(translations).toHaveProperty(key);
});
```

### Value Validation Tests

```typescript
test('all values are non-empty strings', () => {
  for (const key of getAllKeys(translations)) {
    const value = getNestedValue(translations, key);
    expect(typeof value).toBe('string');
    expect(value.trim().length).toBeGreaterThan(0);
  }
});
```

### Interpolation Syntax Tests

```typescript
test('uses correct interpolation syntax', () => {
  const json = JSON.stringify(translations);
  // Check for {{variable}} format
  const matches = json.match(/\{\{[\w]+\}\}/g);
  if (matches) {
    matches.forEach(match => {
      expect(match).toMatch(/^\{\{[\w]+\}\}$/);
    });
  }
});
```

---

## File Maintenance

### Adding New Translations

1. Add to en.json first (source of truth)
2. Update es.json with Spanish translations
3. Add tests for new keys
4. Update components to use new keys

### Finding Missing Translations

```typescript
// Compare keys between language files
function findMissingKeys(source, target) {
  const sourceKeys = getAllKeys(source);
  const targetKeys = getAllKeys(target);

  return sourceKeys.filter(key => !targetKeys.includes(key));
}

const missing = findMissingKeys(enTranslations, esTranslations);
```

---

## Common Patterns

### Action Buttons

```json
{
  "actions": {
    "submit": "Submit",
    "cancel": "Cancel",
    "save": "Save",
    "delete": "Delete",
    "edit": "Edit",
    "view": "View"
  }
}
```

### Status Messages

```json
{
  "status": {
    "loading": "Loading...",
    "processing": "Processing...",
    "success": "Success",
    "error": "Error",
    "ready": "Ready"
  }
}
```

### Form Validation

```json
{
  "validation": {
    "required": "This field is required",
    "invalidEmail": "Invalid email format",
    "tooShort": "Must be at least {{min}} characters",
    "tooLong": "Must be at most {{max}} characters"
  }
}
```

### Confirmation Dialogs

```json
{
  "confirmation": {
    "delete": "Are you sure you want to delete this item?",
    "unsavedChanges": "You have unsaved changes. Leave anyway?",
    "cannotUndo": "This action cannot be undone."
  }
}
```

---

## Key Count Guidelines

| App Complexity | Recommended Keys |
|----------------|------------------|
| Simple | 50-100 |
| Medium | 100-300 |
| Complex | 300-1000+ |

ContPAQi AI Bridge: **326 keys** (Medium-Complex)

---

## References

- [i18next Documentation](https://www.i18next.com/)
- [react-i18next](https://react.i18next.com/)
- [i18next Interpolation](https://www.i18next.com/translation-function/interpolation)
- [i18next Pluralization](https://www.i18next.com/translation-function/plurals)
