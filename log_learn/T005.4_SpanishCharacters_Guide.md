# T005.4 Spanish Characters - Learning Guide

## Overview
This guide explains Unicode normalization for proper Spanish character handling.

## Spanish Special Characters

| Character | Name | Common Words |
|-----------|------|--------------|
| á | a acute | fábrica, información |
| é | e acute | café, México |
| í | i acute | día, país |
| ó | o acute | año, razón |
| ú | u acute | menú, útil |
| ñ | n tilde | año, señor |
| ü | u diaeresis | pingüino, bilingüe |

## The Unicode Problem

Same character, two representations:

```
"café" can be:
1. c + a + f + é        (4 code points, composed)
2. c + a + f + e + ́     (5 code points, decomposed)
```

Both look identical but:
```python
"café" == "café"  # Could be False!
len("café") == 4  # Or 5?
```

## Unicode Normalization Forms

| Form | Name | Description |
|------|------|-------------|
| **NFC** | Composed | Single code point per character |
| NFD | Decomposed | Base + combining marks |
| NFKC | Compatibility Composed | + compatibility chars |
| NFKD | Compatibility Decomposed | + compatibility chars |

## Why NFC?

```python
import unicodedata

# NFC: é = U+00E9 (single character)
nfc = unicodedata.normalize('NFC', 'café')
len(nfc)  # 4

# NFD: e + ́ = U+0065 + U+0301 (two code points)
nfd = unicodedata.normalize('NFD', 'café')
len(nfd)  # 5
```

**NFC is better for:**
- String comparison
- Database storage
- Text searching
- Consistent behavior

## Implementation

```python
import unicodedata

def normalize_text(self, text: str) -> str:
    """Normalize Spanish text to NFC form."""
    if not text:
        return text
    return unicodedata.normalize('NFC', text)
```

## Integration with OCR

```python
def extract_words(self, image, min_confidence=0.0):
    for i in range(n_boxes):
        text = data['text'][i].strip()
        text = self.normalize_text(text)  # Normalize!
        # ... rest of processing
```

## Best Practices

1. **Always normalize OCR output** - Tesseract output varies
2. **Use NFC** - Most compatible form
3. **Normalize early** - Before any string operations
4. **Test with actual Spanish text** - "información", "año", "señor"
