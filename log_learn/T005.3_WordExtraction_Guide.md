# T005.3 Word Extraction - Learning Guide

## Overview
This guide explains how to extract words with their positions (bounding boxes) from images.

## image_to_data vs image_to_string

| Method | Returns | Use Case |
|--------|---------|----------|
| `image_to_string()` | Plain text | Simple text extraction |
| `image_to_data()` | Dict with positions | Word-level extraction |

## Tesseract Data Output

```python
data = pytesseract.image_to_data(image, output_type=Output.DICT)
```

Returns dictionary with arrays:
```python
{
    'text': ['Invoice', 'Total:', '$1,234'],
    'conf': [95, 87, 92],           # Confidence (0-100)
    'left': [10, 10, 100],          # X position
    'top': [20, 50, 50],            # Y position
    'width': [80, 60, 70],          # Box width
    'height': [20, 20, 20]          # Box height
}
```

## Bounding Box Conversion

Tesseract gives: `(left, top, width, height)`
We need: `(x1, y1, x2, y2)`

```python
x1 = data['left'][i]
y1 = data['top'][i]
x2 = x1 + data['width'][i]
y2 = y1 + data['height'][i]
bbox = (x1, y1, x2, y2)
```

## Confidence Filtering

### Why Filter?
- Tesseract returns -1 for invalid detections
- Low confidence = unreliable recognition
- Filtering improves downstream processing

### Implementation
```python
def extract_words(self, image, min_confidence=0.0):
    for i in range(n_boxes):
        conf = data['conf'][i]

        # Skip invalid
        if conf < 0:
            continue

        # Skip low confidence
        if conf / 100.0 < min_confidence:
            continue
```

## Filtering Empty Text

```python
text = data['text'][i].strip()
if not text:
    continue  # Skip whitespace-only
```

## Complete Flow

```
Image
  ↓
pytesseract.image_to_data()
  ↓
Filter: conf >= 0, text not empty, conf >= min_confidence
  ↓
Convert: (left,top,w,h) → (x1,y1,x2,y2)
  ↓
Normalize: conf/100 → 0.0-1.0
  ↓
List[OCRWord]
```
