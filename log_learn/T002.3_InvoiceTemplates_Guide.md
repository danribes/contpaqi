# T002.3 - Invoice Templates - Learning Guide

**Subtask**: 2.3 - Design 10 distinct HTML/CSS invoice templates
**Date**: 2025-12-03
**Audience**: Developers creating Jinja2 templates for PDF invoices

---

## What Was Built

10 distinct HTML/CSS invoice templates using Jinja2 templating syntax, designed for PDF generation with WeasyPrint.

---

## Understanding Jinja2 Templates

### Basic Syntax

```jinja2
{# This is a comment #}

{{ variable }}              - Output a variable
{{ object.property }}       - Access object property
{{ "%.2f"|format(num) }}    - Apply a filter

{% if condition %}          - Control flow
{% endif %}

{% for item in items %}     - Iteration
{% endfor %}
```

### Variable Output

```jinja2
{# Simple variable #}
{{ folio }}

{# Object property #}
{{ emisor.name }}
{{ emisor.rfc }}

{# Formatted number #}
${{ "%.2f"|format(subtotal) }}
```

### Loops for Line Items

```jinja2
{% for item in items %}
<tr>
    <td>{{ item.description }}</td>
    <td>{{ item.quantity }}</td>
    <td>${{ "%.2f"|format(item.unit_price) }}</td>
    <td>${{ "%.2f"|format(item.amount) }}</td>
</tr>
{% endfor %}
```

---

## Template Data Structure

When rendering a template, pass this data structure:

```python
invoice_data = {
    'folio': 'A-00001',
    'date': '2024-03-15',
    'currency': 'MXN',

    'emisor': {
        'name': 'Tecnología Avanzada S.A. de C.V.',
        'rfc': 'TAV850101ABC',
        'address': 'Av. Reforma 123, Col. Centro, CDMX'
    },

    'receptor': {
        'name': 'Comercial del Norte S.A. de C.V.',
        'rfc': 'CDN920515XYZ',
        'address': 'Blvd. Industrial 456, Monterrey, NL'
    },

    'items': [
        {
            'description': 'Servicio de consultoría',
            'quantity': 10,
            'unit_price': 1500.00,
            'amount': 15000.00
        }
    ],

    'subtotal': 15000.00,
    'iva': 2400.00,
    'total': 17400.00
}
```

---

## CSS Design Patterns

### Professional Color Schemes

```css
/* Blue Corporate */
.header { background: #2563eb; color: white; }

/* Green Trust */
.header { background: linear-gradient(135deg, #16a34a, #22c55e); }

/* Purple Modern */
.header { background: linear-gradient(to right, #7c3aed, #a855f7); }

/* Dark Professional */
.header { background: #1e293b; color: white; }
```

### Typography for Invoices

```css
/* Body text */
body { font-family: Arial, sans-serif; font-size: 11px; }

/* Monospace for numbers/RFC */
.rfc { font-family: 'Courier New', monospace; }
.numeric { font-family: 'Courier New', monospace; text-align: right; }

/* Headers */
h1 { font-size: 28px; font-weight: bold; letter-spacing: 2px; }
```

### Table Styling

```css
table {
    width: 100%;
    border-collapse: collapse;
}

th {
    background: #2563eb;
    color: white;
    padding: 12px;
    text-align: left;
    text-transform: uppercase;
    font-size: 10px;
}

td {
    padding: 12px;
    border-bottom: 1px solid #e5e7eb;
}

tr:nth-child(even) {
    background: #f9fafb;
}
```

---

## Layout Techniques

### Flexbox for Headers

```css
.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 25px;
}
```

### Grid for Parties Section

```css
.parties {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
}
```

### Totals Alignment

```css
.totals {
    display: flex;
    justify-content: flex-end;
}

.totals-box {
    width: 280px;
}
```

---

## WeasyPrint Considerations

### Page Setup

```css
@page {
    size: letter;
    margin: 1cm;
}
```

### Print-Safe Fonts

Use web-safe fonts for consistent PDF rendering:
- Arial, Helvetica (sans-serif)
- Times New Roman, Georgia (serif)
- Courier New (monospace)

### Avoid

- External web fonts (may not load)
- JavaScript (not supported)
- Complex animations

---

## Template Variety Strategies

### 1. Color Variations

```css
/* Template 1: Blue */
.header { background: #2563eb; }

/* Template 2: Black */
.header { background: #000; }

/* Template 3: Green */
.header { background: #16a34a; }
```

### 2. Border Styles

```css
/* Template 1: Clean */
border: 1px solid #e5e7eb;

/* Template 2: Double */
border: 3px double #000;

/* Template 4: Dashed */
border: 2px dashed #7c3aed;
```

### 3. Layout Variations

```css
/* Traditional - blocks stacked */
/* Grid - side by side */
/* Card-based - elevated sections */
```

---

## Rendering with Jinja2

```python
from jinja2 import Environment, FileSystemLoader

# Setup
env = Environment(loader=FileSystemLoader('scripts/templates'))
template = env.get_template('template_01.html')

# Render
html = template.render(invoice_data)

# Save or convert to PDF
with open('output.html', 'w') as f:
    f.write(html)
```

---

## Testing Templates

### Check Required Placeholders

```python
def test_has_emisor(template_content):
    assert '{{ emisor' in template_content

def test_has_items_loop(template_content):
    assert '{% for' in template_content
    assert 'items' in template_content
```

### Check Structure

```python
def test_has_table(template_content):
    assert '<table' in template_content.lower()

def test_has_style(template_content):
    assert '<style' in template_content.lower()
```

---

## Common Mistakes

### 1. Forgetting endfor

```jinja2
{# Wrong #}
{% for item in items %}
<tr>...</tr>

{# Correct #}
{% for item in items %}
<tr>...</tr>
{% endfor %}
```

### 2. Missing Filter for Decimals

```jinja2
{# Shows many decimals #}
{{ total }}

{# Shows 2 decimals #}
{{ "%.2f"|format(total) }}
```

### 3. Not Escaping for PDF

Keep HTML simple - avoid complex CSS that WeasyPrint doesn't support.

---

## Next Steps

- **Subtask 2.4**: Integrate templates with WeasyPrint
- Use `weasyprint.HTML(string=html).write_pdf('output.pdf')`
- Test PDF output quality
