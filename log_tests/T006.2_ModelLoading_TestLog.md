# T006.2 Model Loading - Test Log

## Test Execution Summary
**Date**: 2025-12-07
**Tests**: 25 | **Passed**: 25 | **Failed**: 0

## Test File
`tests/test_task006_2_tatr_loading.py`

## Test Classes

| Class | Tests | Description |
|-------|-------|-------------|
| TestTATRModelLoading | 7 | Init with defaults/custom params |
| TestTATRModelLoadingWithMocks | 4 | from_pretrained, device, eval |
| TestTATRModelLoadingErrors | 2 | Raises without torch/transformers |
| TestEnsureModelLoaded | 2 | Loads if needed, skips if loaded |
| TestModelConstants | 6 | Microsoft model, threshold, labels |

## Key Test Patterns

```python
@patch('models.tatr.TORCH_AVAILABLE', True)
@patch('models.tatr.TRANSFORMERS_AVAILABLE', True)
def test_load_model_calls_from_pretrained(self):
    with patch('models.tatr.AutoImageProcessor') as mock_processor, \
         patch('models.tatr.AutoModelForObjectDetection') as mock_model:
        # ... test code
        mock_processor.from_pretrained.assert_called_once()

def test_load_model_raises_without_torch(self):
    with patch('models.tatr.TORCH_AVAILABLE', False):
        model = TATRModel(load_model=False)
        with pytest.raises(RuntimeError, match="PyTorch"):
            model._load_model()
```

## Issue Fixed
- `torch.cuda` NoneType error when mocking TORCH_AVAILABLE
- Fixed by adding `torch is not None` check

## Execution Output
```
tests/test_task006_2_tatr_loading.py ......................... [100%]
============================== 25 passed in 0.10s ==============================
```
