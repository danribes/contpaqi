# T008.5 Row Intersection Logic - Test Log

## Test Execution Summary
**Date**: 2025-12-07
**Tests**: 21 | **Passed**: 21 | **Failed**: 0

## Test File
`tests/test_task008_5_row_intersection.py`

## Test Classes

| Class | Tests | Description |
|-------|-------|-------------|
| TestAssignWordsToRowsMethodExists | 2 | Method existence |
| TestAssignWordsToRowsSignature | 3 | Parameter validation |
| TestAssignWordsToRowsReturnType | 2 | Return type checks |
| TestAssignWordsToRowsBasicLogic | 3 | Core assignment logic |
| TestAssignWordsToRowsMultipleRows | 2 | Multi-row handling |
| TestAssignWordsToRowsResultStructure | 4 | Result structure |
| TestAssignWordsToRowsEdgeCases | 4 | Edge cases |
| TestAssignWordsToRowsIntegration | 1 | Integration test |

## Key Test Patterns

### Testing Center Y Calculation
```python
def test_word_assigned_to_row_by_center_y(self):
    words = ['Product']
    boxes = [(100, 50, 200, 70)]  # center_y = (50+70)/2 = 60
    rows = [{'bbox': (50, 40, 500, 80), 'index': 0}]  # y range: 40-80

    result = engine._assign_words_to_rows(words, boxes, rows)

    assert len(result) == 1
    assert result[0]['words'][0]['word'] == 'Product'
```

### Testing Boundary Conditions
```python
def test_word_on_row_boundary_upper(self):
    # center_y = 40, exactly at row y1
    words = ['Boundary']
    boxes = [(100, 30, 180, 50)]  # center_y = 40
    rows = [{'bbox': (50, 40, 500, 80), 'index': 0}]

    result = engine._assign_words_to_rows(words, boxes, rows)
    assert len(result) == 1  # Included (<=)
```

### Testing Multiple Rows
```python
def test_words_assigned_to_correct_rows(self):
    words = ['Row1Word', 'Row2Word', 'Row3Word']
    boxes = [
        (100, 50, 180, 70),   # center_y = 60, in row 0
        (100, 110, 180, 130), # center_y = 120, in row 1
        (100, 170, 180, 190), # center_y = 180, in row 2
    ]
    rows = [
        {'bbox': (50, 40, 500, 80), 'index': 0},
        {'bbox': (50, 100, 500, 140), 'index': 1},
        {'bbox': (50, 160, 500, 200), 'index': 2},
    ]

    result = engine._assign_words_to_rows(words, boxes, rows)

    assert len(result) == 3
    assert result[0]['words'][0]['word'] == 'Row1Word'
    assert result[1]['words'][0]['word'] == 'Row2Word'
    assert result[2]['words'][0]['word'] == 'Row3Word'
```

### Testing Realistic Table
```python
def test_realistic_table_scenario(self):
    # Header + 2 data rows with multiple words each
    result = engine._assign_words_to_rows(words, boxes, rows)

    assert len(result) == 3
    assert len(result[0]['words']) == 4  # Header: 4 words
    assert len(result[1]['words']) == 5  # Data row 1: 5 words
    assert len(result[2]['words']) == 5  # Data row 2: 5 words
```

## Execution Output
```
tests/test_task008_5_row_intersection.py ..................... [100%]
============================== 21 passed in 0.09s ==============================
```
