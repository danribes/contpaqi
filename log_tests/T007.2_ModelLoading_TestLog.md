# T007.2 LayoutLMv3 Model Loading - Test Log

## Test Execution Summary
**Date**: 2025-12-07
**Tests**: 23 | **Passed**: 23 | **Failed**: 0

## Test File
`tests/test_task007_2_layoutlm_loading.py`

## Test Classes

| Class | Tests | Description |
|-------|-------|-------------|
| TestLayoutLMModelLoading | 8 | Init, device, label mappings |
| TestLayoutLMModelLoadingWithMocks | 5 | from_pretrained, to(), eval() |
| TestLayoutLMModelLoadingErrors | 2 | Error handling |
| TestEnsureModelLoaded | 2 | Lazy loading behavior |
| TestModelConstants | 5 | Constants validation |
| TestNumLabelsParameter | 1 | num_labels=21 |

## Key Test Patterns

```python
@patch('models.layoutlm.TORCH_AVAILABLE', True)
@patch('models.layoutlm.TRANSFORMERS_AVAILABLE', True)
def test_load_model_calls_model_from_pretrained(self):
    with patch('models.layoutlm.LayoutLMv3Processor') as mock_processor, \
         patch('models.layoutlm.LayoutLMv3ForTokenClassification') as mock_model:

        mock_processor.from_pretrained.return_value = Mock()
        mock_model.from_pretrained.return_value = Mock()

        model = LayoutLMModel(load_model=False)
        model._load_model()

        mock_model.from_pretrained.assert_called_once_with(
            model.model_name,
            num_labels=len(model.LABELS)
        )

def test_label_mappings_are_consistent(self):
    model = LayoutLMModel(load_model=False)
    for label, idx in model.label2id.items():
        assert model.id2label[idx] == label
```

## Execution Output
```
tests/test_task007_2_layoutlm_loading.py ....................... [100%]
============================== 23 passed in 0.12s ==============================
```
